---
title: "ä½¿ç”¨ PlatformIO + Vim æ­å»ºåµŒå…¥å¼å¼€å‘ç¯å¢ƒ"
date: 2025-04-01
categories: [æŠ€æœ¯]  # åˆ†ç±»ï¼ˆå¯é€‰ï¼‰
tags: [æŠ€æœ¯, åµŒå…¥å¼å¼€å‘, PlatformIO, Vim]       # æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰
---


------

## ğŸ“Œ ç®€ä»‹

PlatformIO æ˜¯ä¸€ä¸ªå¼€æºçš„ç‰©è”ç½‘å¼€å‘ç”Ÿæ€ç³»ç»Ÿï¼Œæ”¯æŒ Arduinoã€ESP8266ã€STM32 ç­‰ 50+ å¼€å‘æ¿ã€‚ç»“åˆ Vim ç¼–è¾‘å™¨ï¼Œå¯å®ç°è½»é‡é«˜æ•ˆçš„åµŒå…¥å¼å¼€å‘ã€‚æœ¬æ–‡å°†æ¼”ç¤ºå¦‚ä½•ä»é›¶æ­å»ºç¯å¢ƒã€å¼€å‘ä»£ç ã€è°ƒè¯•ä¸çƒ§å½•ã€‚

------

## 1ï¸âƒ£ å®‰è£… PlatformIO

é€šè¿‡ Python çš„ `pip` å·¥å…·å®‰è£…ï¼ˆéœ€æå‰å®‰è£… Python3ï¼‰ï¼š

```bash
pip3 install platformio
```

------

## 2ï¸âƒ£ åˆ›å»ºå·¥ç¨‹

### æŸ¥æ‰¾æ”¯æŒçš„å¼€å‘æ¿

```bash
# åˆ—å‡ºæ‰€æœ‰æ”¯æŒçš„å¼€å‘æ¿
platformio boards

# æŒ‰èŠ¯ç‰‡å‹å·ç­›é€‰ï¼ˆä¾‹å¦‚ ATmega328Pï¼‰
platformio boards | grep "ATmega328P"
```

è¾“å‡ºç¤ºä¾‹ï¼š

```bash
ATmega328P     ATMEGA328P  16MHz  32KB  2KB  ATmega328P/PA
ATmega328PB    ATMEGA328PB 16MHz  32KB  2KB  ATmega328PB
```

### åˆå§‹åŒ–å·¥ç¨‹

```bash
# åˆ›å»ºä»¥ ATmega328P ä¸ºåŸºç¡€çš„å·¥ç¨‹
platformio project init --board ATmega328P
cd ATmega328P  # è¿›å…¥å·¥ç¨‹ç›®å½•
```

------

## 3ï¸âƒ£ ç¼–å†™ä»£ç ï¼ˆVimï¼‰

è¿›å…¥å·¥ç¨‹ç›®å½•ï¼Œç”¨ Vim ç¼–å†™ä»£ç ï¼š

```bash
vim src/main.cpp
```

ç¤ºä¾‹ä»£ç ï¼š**æ§åˆ¶ 3 ä¸ª LED é—ªçƒ**

```cpp
#include <Arduino.h>

const int ledPin1 = 3;  // å¼•è„šå®šä¹‰
const int ledPin2 = 4;
const int ledPin3 = 5;

void setup() {
    pinMode(ledPin1, OUTPUT);
    pinMode(ledPin2, OUTPUT);
    pinMode(ledPin3, OUTPUT);
}

void loop() {
    while(true) {
        digitalWrite(ledPin1, HIGH);  // ç‚¹äº® LED
        digitalWrite(ledPin2, HIGH);
        digitalWrite(ledPin3, HIGH);
        delay(200);
        digitalWrite(ledPin1, LOW);   // ç†„ç­ LED
        digitalWrite(ledPin2, LOW);
        digitalWrite(ledPin3, LOW);
        delay(100);
    }
}
```

**Vim ä¿å­˜é€€å‡ºå‘½ä»¤**

- æŒ‰ `Esc` â†’ è¾“å…¥ `:wq` â†’ å›è½¦

------

## 4ï¸âƒ£ ç¼–è¯‘ä¸çƒ§å½•

```bash
# ç¼–è¯‘ä»£ç å¹¶çƒ§å½•åˆ°è®¾å¤‡
platformio run --target upload
```

------

## 5ï¸âƒ£ è°ƒè¯•é…ç½®

### é…ç½®è°ƒè¯•å™¨

ç¼–è¾‘ å½“å‰å·¥ç¨‹ä¸‹`platformio.ini`æ–‡ä»¶ï¼Œæ·»åŠ è°ƒè¯•å·¥å…·ï¼ˆå¦‚ ST-Linkï¼‰ï¼š

```bash
ini
[env:ATmega328P]
platform = atmelavr
board = ATmega328P
framework = arduino
debug_tool = stlink  # æ”¯æŒ jlink, stlink, avr ç­‰
```

### å¯åŠ¨è°ƒè¯•

1. **è®¾ç½®æ–­ç‚¹**ï¼šåœ¨ä»£ç è¡Œå·å·¦ä¾§ç‚¹å‡»æ·»åŠ æ–­ç‚¹ã€‚
2. å¼€å§‹è°ƒè¯•
   - VSCodeï¼šæŒ‰ `F5` æˆ–ç‚¹å‡»è°ƒè¯•å›¾æ ‡ã€‚
   - å‘½ä»¤è¡Œï¼š`platformio debug --interface=gdb`

------

## 6ï¸âƒ£ ä¸²å£æ‰“å°è°ƒè¯•

### ä»£ç ç¤ºä¾‹

```bash
#include <Arduino.h>

const int ledPin = 13;

void setup() {
    pinMode(ledPin, OUTPUT);
    Serial.begin(9600);  // åˆå§‹åŒ–ä¸²å£
    Serial.println("Setup complete.");
}

void loop() {
    digitalWrite(ledPin, HIGH);
    Serial.println("LED ON");
    delay(1000);
    
    digitalWrite(ledPin, LOW);
    Serial.println("LED OFF");
    delay(1000);
}
```

### ç›‘æ§ä¸²å£è¾“å‡º

```bash
# å‘½ä»¤æ‰“å¼€ä¸²å£è°ƒè¯•
platformio device monitor
```

è¾“å‡ºç¤ºä¾‹ï¼š

```bash
--- Terminal on /dev/ttyUSB0 | 9600 8-N-1
LED ON
LED OFF
LED ON
```

------

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é©±åŠ¨é—®é¢˜**ï¼šç¡®ä¿è®¾å¤‡å·²æ­£ç¡®å®‰è£…é©±åŠ¨ï¼ˆå¦‚ CH340 é©±åŠ¨ï¼‰ã€‚
2. **ä¸²å£æƒé™**ï¼šLinux/Mac å¯èƒ½éœ€è¦ `sudo chmod 666 /dev/ttyUSB0`ã€‚
3. **è°ƒè¯•å™¨å…¼å®¹æ€§**ï¼šä¸åŒå¼€å‘æ¿éœ€åŒ¹é…å¯¹åº”çš„è°ƒè¯•å·¥å…·ã€‚

------

## ğŸŒŸ æ€»ç»“

é€šè¿‡ PlatformIO + Vim çš„ç»„åˆï¼Œä½ å¯ä»¥å¿«é€Ÿæ­å»ºè½»é‡çº§åµŒå…¥å¼å¼€å‘ç¯å¢ƒï¼Œäº«å—é«˜æ•ˆçš„ä»£ç ç¼–å†™ã€è°ƒè¯•ä¸çƒ§å½•ä½“éªŒã€‚å¦‚éœ€è¿›ä¸€æ­¥ä¼˜åŒ–ï¼ˆå¦‚è‡ªå®šä¹‰ Vim æ’ä»¶ï¼‰ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµï¼

------

**ä¸‹ä¸€ç¯‡é¢„å‘Š**ï¼šå¦‚ä½•ä¸º PlatformIO é…ç½® Vim è‡ªåŠ¨è¡¥å…¨ä¸è¯­æ³•æ£€æŸ¥ã€‚
